{"database_id":2,"parameterized":false,"started_at":"2026-01-27T14:19:01.513845969Z","via":[{"status":"failed","class":"class clojure.lang.ExceptionInfo","error":"Error executing query: ERROR: column \"%demo%\" does not exist\n  Position: 10631","stacktrace":["--> driver.sql_jdbc.execute$execute_reducible_query$fn__93361$fn__93362.invoke(execute.clj:780)","driver.sql_jdbc.execute$execute_reducible_query$fn__93361.invoke(execute.clj:777)","driver.sql_jdbc.execute$fn__93136$fn__93137.invoke(execute.clj:432)","driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:348)","driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:328)","driver.sql_jdbc.execute$fn__93136.invokeStatic(execute.clj:426)","driver.sql_jdbc.execute$fn__93136.invoke(execute.clj:424)","driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:770)","driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:759)","driver.sql_jdbc$fn__96050.invokeStatic(sql_jdbc.clj:87)","driver.sql_jdbc$fn__96050.invoke(sql_jdbc.clj:85)","query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:59)","query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:44)","query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:119)","query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:108)","query_processor.execute$run.invokeStatic(execute.clj:72)","query_processor.execute$run.invoke(execute.clj:62)","query_processor.middleware.enterprise$swap_destination_db_middleware$fn__73480.invoke(enterprise.clj:75)","query_processor.middleware.enterprise$apply_impersonation_postprocessing_middleware$fn__73462.invoke(enterprise.clj:50)","query_processor.middleware.update_used_cards$update_used_cards_BANG_$fn__76020.invoke(update_used_cards.clj:67)","query_processor.execute$add_native_form_to_result_metadata$fn__76060.invoke(execute.clj:27)","query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__76067.invoke(execute.clj:39)","query_processor.middleware.cache$run_query_with_cache.invokeStatic(cache.clj:221)","query_processor.middleware.cache$run_query_with_cache.invoke(cache.clj:194)","query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___75986.invoke(cache.clj:247)","query_processor.middleware.permissions$check_query_permissions$fn__72653.invoke(permissions.clj:153)","query_processor.middleware.enterprise$check_download_permissions_middleware$fn__73490.invoke(enterprise.clj:92)","query_processor.execute$execute$fn__76099.invoke(execute.clj:99)","query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:232)","query_processor.setup$do_with_qp_setup.invoke(setup.clj:223)","query_processor.execute$execute.invokeStatic(execute.clj:98)","query_processor.execute$execute.invoke(execute.clj:94)","query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:50)","query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:45)","query_processor.middleware.enterprise$fn__73507$handle_audit_app_internal_queries__73508$fn__73510.invoke(enterprise.clj:124)","query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73518.invoke(enterprise.clj:131)","query_processor.middleware.process_userland_query$process_userland_query_middleware$fn__80995.invoke(process_userland_query.clj:185)","query_processor.middleware.catch_exceptions$catch_exceptions$fn__81055.invoke(catch_exceptions.clj:139)","query_processor$process_query$fn__81095.invoke(query_processor.clj:81)","query_processor.setup$do_with_canceled_chan$fn__75389.invoke(setup.clj:194)","query_processor.setup$do_with_database_local_settings$fn__75384.invoke(setup.clj:188)","query_processor.setup$do_with_driver$fn__75375$fn__75376.invoke(setup.clj:173)","driver$do_with_driver.invokeStatic(driver.clj:54)","driver$do_with_driver.invoke(driver.clj:49)","query_processor.setup$do_with_driver$fn__75375.invoke(setup.clj:172)","query_processor.setup$do_with_metadata_provider$fn__75367.invoke(setup.clj:137)","query_processor.setup$do_with_resolved_database$fn__75359.invoke(setup.clj:125)","query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:240)","query_processor.setup$do_with_qp_setup.invoke(setup.clj:223)","query_processor$process_query.invokeStatic(query_processor.clj:79)","query_processor$process_query.invoke(query_processor.clj:72)","query_processor.card$process_query_for_card_default_qp.invokeStatic(card.clj:235)","query_processor.card$process_query_for_card_default_qp.invoke(card.clj:231)","query_processor.card$process_query_for_card_default_run_fn$fn__89846$fn__89847.invoke(card.clj:243)","query_processor.streaming$_streaming_response$fn__86559$fn__86560$fn__86561.invoke(streaming.clj:225)","query_processor.streaming$_streaming_response$fn__86559$fn__86560.invoke(streaming.clj:223)","query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:214)","query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:201)","query_processor.streaming$_streaming_response$fn__86559.invoke(streaming.clj:220)","server.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:83)","server.streaming_response$do_f_STAR_.invoke(streaming_response.clj:81)","server.streaming_response$do_f_async$task__84295.invoke(streaming_response.clj:98)"],"error_type":"invalid-query","ex-data":{"driver":"postgres","sql":["-- Metabase:: userID: 3 queryType: native queryHash: a1f0d29b4cf61cdb679b8455b68e642696f7f9e898d00347515ed19b04886544","with d_agg as (","  select","    type,","    leg,","    pickup_city,","    customer_address_city,","    destination_city,","    entity,","    max(median_duration_days) as median_duration_days","  from","    (","      -- load_durations","      WITH pickup_logs AS (","        SELECT","          tl.transaction_key,","          MAX(","            CASE","              WHEN tr.type = 'tt6a4151435418c5ae'","              AND tl.\"to\" = 'AT_PICKUP_LOCATION' THEN -- Domestic","              tl.actual_created_on","              WHEN tr.type = 'tt5f84c5bcf7730bfa394'","              AND tr.leg = 'lt50731c5666598943'","              AND tl.\"to\" = 'PICKING_UP_CONTAINER' THEN -- import shuttle","              tl.actual_created_on","              WHEN tr.type = 'tt5f84c5bcf7730bfa394'","              AND tr.leg = 'l70742c5666598965'","              AND tl.\"to\" = 'AT_STAGING_DEPOT' THEN -- import trip","              tl.actual_created_on","              WHEN tr.type = 'tt7269f3a39fe8edc6'","              AND tr.leg = 'lt50731c5666598943'","              AND tl.\"to\" = 'AT_STAGING_DEPOT' THEN tl.actual_created_on","              WHEN tr.type = 'tt7269f3a39fe8edc6'","              AND tr.leg = 'l70742c5666598965'","              AND tl.\"to\" = 'AT_EMPTY_CONTAINER_DEPOT' THEN tl.actual_created_on","              ELSE tr.pickup_date","            END","          ) AS pickup_on","        FROM","          transaction_logs tl","          JOIN transactions_raw tr ON tl.transaction_key = tr.key","          AND tr.status = 'COMPLETED'","          AND tr.country = 'sa'","          AND tr.rental = 'true'","          AND tr.number_of_addresses <= 3","          AND tr.pickup_date >= (NOW() - INTERVAL '365 days')","        WHERE","          tl.is_deleted = false","        GROUP BY","          1","      ),","      completed_logs AS (","        SELECT","          tl.transaction_key,","          MAX(tl.actual_created_on) AS completed_on","        FROM","          transaction_logs tl","          JOIN transactions_raw tr ON tl.transaction_key = tr.key","          AND tr.rental = 'true'","          AND tr.status = 'COMPLETED'","          AND tr.country = 'sa'","          AND tr.pickup_date >= (NOW() - INTERVAL '365 days')","        WHERE","          tl.is_deleted = false","          AND tl.\"to\" = 'COMPLETED'","        GROUP BY","          1","      ),","      historical_loads_enriched AS (","        SELECT","          tr.key,","          tr.entity,","          tr.shipper_key,","          tr.type,","          tr.leg,","          tr.pickup_city,","          tr.customer_address_city,","          tr.destination_city,","          -- -- Calculate final, reliable distance","          -- GREATEST(","          --     tr.distance,","          --     earth_distance(ll_to_earth(tr.pickup_lat, tr.pickup_lng), ll_to_earth(tr.dropoff_lat, tr.dropoff_lng)) / 1000","          -- ) AS final_distance,","          -- Calculate actual duration in days","          (cl.completed_on :: date - pl.pickup_on :: date) AS duration_days","        FROM","          transactions_raw tr","          JOIN pickup_logs pl ON tr.key = pl.transaction_key","          JOIN completed_logs cl ON tr.key = cl.transaction_key","        WHERE","          tr.rental = 'true'","          AND tr.status = 'COMPLETED'","          AND tr.country = 'sa'","          AND tr.pickup_date >= (NOW() - INTERVAL '1 year') -- Use a rolling history for relevance","          AND cl.completed_on IS NOT NULL","      ),","      -- CTE 4: Final preparation before aggregation, adding lane_type and filtering out bad data","      final_dataset AS (","        SELECT","          h.type,","          h.leg,","          h.entity,","          h.shipper_key,","          h.pickup_city,","          h.customer_address_city,","          h.destination_city,","          h.duration_days -- -- Define the lane type based on cities and distance","          -- CASE","          --     WHEN h.pickup_city = h.destination_city AND h.final_distance > 400 THEN 'Round-Trip'","          --     ELSE 'One-Way'","          -- END AS lane_type","        FROM","          historical_loads_enriched h -- Data quality filter: remove illogical durations","        WHERE","          h.duration_days > 0","          AND h.duration_days < 15","      )","      SELECT","        COALESCE(fd.entity, 'Overall') AS entity,","        fd.type,","        fd.leg,","        fd.pickup_city,","        fd.customer_address_city,","        fd.destination_city,","        COUNT(*) AS transaction_count,","        percentile_cont(0.5) WITHIN GROUP (","          ORDER BY","            duration_days","        ) AS median_duration_days,","        '\"shipperKeys\": [' || CASE","          WHEN fd.shipper_key IS NOT NULL THEN '\"' || fd.shipper_key || '\"'","          ELSE ''","        END || '], ' || '\"cityKeys\": [\"' || COALESCE(fd.pickup_city, '') || '-' || COALESCE(fd.customer_address_city, '') || '-' || COALESCE(fd.destination_city, '') || '\"], ' || '\"legs\": [' || COALESCE('\"' || fd.leg || '\"', '') || '], ' || '\"typeKeys\": [' || COALESCE('\"' || fd.type || '\"', '') || ']' AS request_json","      FROM","        final_dataset fd","      GROUP BY","        CUBE(fd.entity),","        fd.type,","        fd.leg,","        fd.shipper_key,","        fd.pickup_city,","        fd.customer_address_city,","        fd.destination_city","      order by","        count(*) desc","    )","  group by","    type,","    leg,","    pickup_city,","    customer_address_city,","    destination_city,","    entity","),","d_overall_agg as (","  select","    type,","    leg,","    pickup_city,","    customer_address_city,","    destination_city,","    entity,","    max(median_duration_days) as median_duration_days","  from","    (","      -- load_durations","      WITH pickup_logs AS (","        SELECT","          tl.transaction_key,","          MAX(","            CASE","              WHEN tr.type = 'tt6a4151435418c5ae'","              AND tl.\"to\" = 'AT_PICKUP_LOCATION' THEN -- Domestic","              tl.actual_created_on","              WHEN tr.type = 'tt5f84c5bcf7730bfa394'","              AND tr.leg = 'lt50731c5666598943'","              AND tl.\"to\" = 'PICKING_UP_CONTAINER' THEN -- import shuttle","              tl.actual_created_on","              WHEN tr.type = 'tt5f84c5bcf7730bfa394'","              AND tr.leg = 'l70742c5666598965'","              AND tl.\"to\" = 'AT_STAGING_DEPOT' THEN -- import trip","              tl.actual_created_on","              WHEN tr.type = 'tt7269f3a39fe8edc6'","              AND tr.leg = 'lt50731c5666598943'","              AND tl.\"to\" = 'AT_STAGING_DEPOT' THEN tl.actual_created_on","              WHEN tr.type = 'tt7269f3a39fe8edc6'","              AND tr.leg = 'l70742c5666598965'","              AND tl.\"to\" = 'AT_EMPTY_CONTAINER_DEPOT' THEN tl.actual_created_on","              ELSE tr.pickup_date","            END","          ) AS pickup_on","        FROM","          transaction_logs tl","          JOIN transactions_raw tr ON tl.transaction_key = tr.key","          AND tr.status = 'COMPLETED'","          AND tr.country = 'sa'","          AND tr.rental = 'true'","          AND tr.number_of_addresses <= 3","          AND tr.pickup_date >= (NOW() - INTERVAL '365 days')","        WHERE","          tl.is_deleted = false","        GROUP BY","          1","      ),","      completed_logs AS (","        SELECT","          tl.transaction_key,","          MAX(tl.actual_created_on) AS completed_on","        FROM","          transaction_logs tl","          JOIN transactions_raw tr ON tl.transaction_key = tr.key","          AND tr.rental = 'true'","          AND tr.status = 'COMPLETED'","          AND tr.country = 'sa'","          AND tr.pickup_date >= (NOW() - INTERVAL '365 days')","        WHERE","          tl.is_deleted = false","          AND tl.\"to\" = 'COMPLETED'","        GROUP BY","          1","      ),","      historical_loads_enriched AS (","        SELECT","          tr.key,","          tr.entity,","          tr.shipper_key,","          tr.type,","          tr.leg,","          tr.pickup_city,","          tr.customer_address_city,","          tr.destination_city,","          -- -- Calculate final, reliable distance","          -- GREATEST(","          --     tr.distance,","          --     earth_distance(ll_to_earth(tr.pickup_lat, tr.pickup_lng), ll_to_earth(tr.dropoff_lat, tr.dropoff_lng)) / 1000","          -- ) AS final_distance,","          -- Calculate actual duration in days","          (cl.completed_on :: date - pl.pickup_on :: date) AS duration_days","        FROM","          transactions_raw tr","          JOIN pickup_logs pl ON tr.key = pl.transaction_key","          JOIN completed_logs cl ON tr.key = cl.transaction_key","        WHERE","          tr.rental = 'true'","          AND tr.status = 'COMPLETED'","          AND tr.country = 'sa'","          AND tr.pickup_date >= (NOW() - INTERVAL '1 year') -- Use a rolling history for relevance","          AND cl.completed_on IS NOT NULL","      ),","      -- CTE 4: Final preparation before aggregation, adding lane_type and filtering out bad data","      final_dataset AS (","        SELECT","          h.type,","          h.leg,","          h.entity,","          h.shipper_key,","          h.pickup_city,","          h.customer_address_city,","          h.destination_city,","          h.duration_days -- -- Define the lane type based on cities and distance","          -- CASE","          --     WHEN h.pickup_city = h.destination_city AND h.final_distance > 400 THEN 'Round-Trip'","          --     ELSE 'One-Way'","          -- END AS lane_type","        FROM","          historical_loads_enriched h -- Data quality filter: remove illogical durations","        WHERE","          h.duration_days > 0","          AND h.duration_days < 15","      )","      SELECT","        COALESCE(fd.entity, 'Overall') AS entity,","        fd.type,","        fd.leg,","        fd.pickup_city,","        fd.customer_address_city,","        fd.destination_city,","        COUNT(*) AS transaction_count,","        percentile_cont(0.5) WITHIN GROUP (","          ORDER BY","            duration_days","        ) AS median_duration_days,","        '\"shipperKeys\": [' || CASE","          WHEN fd.shipper_key IS NOT NULL THEN '\"' || fd.shipper_key || '\"'","          ELSE ''","        END || '], ' || '\"cityKeys\": [\"' || COALESCE(fd.pickup_city, '') || '-' || COALESCE(fd.customer_address_city, '') || '-' || COALESCE(fd.destination_city, '') || '\"], ' || '\"legs\": [' || COALESCE('\"' || fd.leg || '\"', '') || '], ' || '\"typeKeys\": [' || COALESCE('\"' || fd.type || '\"', '') || ']' AS request_json","      FROM","        final_dataset fd","      GROUP BY","        CUBE(fd.entity),","        fd.type,","        fd.leg,","        fd.shipper_key,","        fd.pickup_city,","        fd.customer_address_city,","        fd.destination_city","      order by","        count(*) desc","    )","  where","    entity = 'Overall'","  group by","    type,","    leg,","    pickup_city,","    customer_address_city,","    destination_city,","    entity",")","select","  date_trunc('month', t.pickup_date) :: date as month,","  t.key,","  t.id :: text,","  t.entity,","  t.shipper_price,","  t.distance,","  t.pickup_date,","  t.pickup_lat,","  t.pickup_lng,","  t.dropoff_lat,","  t.dropoff_lng,","  t.number_of_addresses,","  coalesce(","    d.median_duration_days,","    d_overall.median_duration_days,","    ceil(t.distance / 700.0)","  ) as median_duration_days","from","  transactions_raw t","  left join d_agg d on d.type = t.type","  and d.leg = t.leg","  and d.pickup_city = t.pickup_city","  and d.customer_address_city IS NOT DISTINCT","FROM","  t.customer_address_city","  and d.destination_city = t.destination_city","  and d.entity = t.entity","  left join d_overall_agg d_overall on d_overall.type = t.type","  and d_overall.leg = t.leg","  and d_overall.pickup_city = t.pickup_city","  and d_overall.customer_address_city IS NOT DISTINCT","FROM","  t.customer_address_city","  and d_overall.destination_city = t.destination_city","  and d_overall.entity = 'Overall'","where","  t.entity not ilike \"%demo%\"","  and t.entity not ilike '%test%'","  and t.country = 'sa'","  and date_trunc('month', t.pickup_date) >= '2025-01-01'","  and t.type != 'tt7b5804195857a590'","  and t.leg != 'lt50731c5666598943'","  and t.status != 'CANCELLED_BY_SHIPPER'","  and t.shipper_price > 0;"],"params":[],"type":"invalid-query"}}],"action_id":null,"state":"42703","error_type":"invalid-query","status":"failed","class":"class org.postgresql.util.PSQLException","stacktrace":["org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:2736)","org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:2421)","org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:372)","org.postgresql.jdbc.PgStatement.executeInternal(PgStatement.java:525)","org.postgresql.jdbc.PgStatement.execute(PgStatement.java:435)","org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:357)","org.postgresql.jdbc.PgStatement.executeCachedSql(PgStatement.java:342)","org.postgresql.jdbc.PgStatement.executeWithFlags(PgStatement.java:318)","org.postgresql.jdbc.PgStatement.execute(PgStatement.java:313)","com.mchange.v2.c3p0.impl.NewProxyStatement.execute(NewProxyStatement.java:1341)","--> driver.sql_jdbc.execute$fn__93267.invokeStatic(execute.clj:592)","driver.sql_jdbc.execute$fn__93267.invoke(execute.clj:590)","driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invokeStatic(execute.clj:600)","driver.sql_jdbc.execute$execute_statement_or_prepared_statement_BANG_.invoke(execute.clj:597)","driver.sql_jdbc.execute$execute_reducible_query$fn__93361$fn__93362.invoke(execute.clj:778)","driver.sql_jdbc.execute$execute_reducible_query$fn__93361.invoke(execute.clj:777)","driver.sql_jdbc.execute$fn__93136$fn__93137.invoke(execute.clj:432)","driver.sql_jdbc.execute$do_with_resolved_connection.invokeStatic(execute.clj:348)","driver.sql_jdbc.execute$do_with_resolved_connection.invoke(execute.clj:328)","driver.sql_jdbc.execute$fn__93136.invokeStatic(execute.clj:426)","driver.sql_jdbc.execute$fn__93136.invoke(execute.clj:424)","driver.sql_jdbc.execute$execute_reducible_query.invokeStatic(execute.clj:770)","driver.sql_jdbc.execute$execute_reducible_query.invoke(execute.clj:759)","driver.sql_jdbc$fn__96050.invokeStatic(sql_jdbc.clj:87)","driver.sql_jdbc$fn__96050.invoke(sql_jdbc.clj:85)","query_processor.pipeline$_STAR_execute_STAR_.invokeStatic(pipeline.clj:59)","query_processor.pipeline$_STAR_execute_STAR_.invoke(pipeline.clj:44)","query_processor.pipeline$_STAR_run_STAR_.invokeStatic(pipeline.clj:119)","query_processor.pipeline$_STAR_run_STAR_.invoke(pipeline.clj:108)","query_processor.execute$run.invokeStatic(execute.clj:72)","query_processor.execute$run.invoke(execute.clj:62)","query_processor.middleware.enterprise$swap_destination_db_middleware$fn__73480.invoke(enterprise.clj:75)","query_processor.middleware.enterprise$apply_impersonation_postprocessing_middleware$fn__73462.invoke(enterprise.clj:50)","query_processor.middleware.update_used_cards$update_used_cards_BANG_$fn__76020.invoke(update_used_cards.clj:67)","query_processor.execute$add_native_form_to_result_metadata$fn__76060.invoke(execute.clj:27)","query_processor.execute$add_preprocessed_query_to_result_metadata_for_userland_query$fn__76067.invoke(execute.clj:39)","query_processor.middleware.cache$run_query_with_cache.invokeStatic(cache.clj:221)","query_processor.middleware.cache$run_query_with_cache.invoke(cache.clj:194)","query_processor.middleware.cache$maybe_return_cached_results$maybe_return_cached_results_STAR___75986.invoke(cache.clj:247)","query_processor.middleware.permissions$check_query_permissions$fn__72653.invoke(permissions.clj:153)","query_processor.middleware.enterprise$check_download_permissions_middleware$fn__73490.invoke(enterprise.clj:92)","query_processor.execute$execute$fn__76099.invoke(execute.clj:99)","query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:232)","query_processor.setup$do_with_qp_setup.invoke(setup.clj:223)","query_processor.execute$execute.invokeStatic(execute.clj:98)","query_processor.execute$execute.invoke(execute.clj:94)","query_processor$process_query_STAR__STAR_.invokeStatic(query_processor.clj:50)","query_processor$process_query_STAR__STAR_.invoke(query_processor.clj:45)","query_processor.middleware.enterprise$fn__73507$handle_audit_app_internal_queries__73508$fn__73510.invoke(enterprise.clj:124)","query_processor.middleware.enterprise$handle_audit_app_internal_queries_middleware$fn__73518.invoke(enterprise.clj:131)","query_processor.middleware.process_userland_query$process_userland_query_middleware$fn__80995.invoke(process_userland_query.clj:185)","query_processor.middleware.catch_exceptions$catch_exceptions$fn__81055.invoke(catch_exceptions.clj:139)","query_processor$process_query$fn__81095.invoke(query_processor.clj:81)","query_processor.setup$do_with_canceled_chan$fn__75389.invoke(setup.clj:194)","query_processor.setup$do_with_database_local_settings$fn__75384.invoke(setup.clj:188)","query_processor.setup$do_with_driver$fn__75375$fn__75376.invoke(setup.clj:173)","driver$do_with_driver.invokeStatic(driver.clj:54)","driver$do_with_driver.invoke(driver.clj:49)","query_processor.setup$do_with_driver$fn__75375.invoke(setup.clj:172)","query_processor.setup$do_with_metadata_provider$fn__75367.invoke(setup.clj:137)","query_processor.setup$do_with_resolved_database$fn__75359.invoke(setup.clj:125)","query_processor.setup$do_with_qp_setup.invokeStatic(setup.clj:240)","query_processor.setup$do_with_qp_setup.invoke(setup.clj:223)","query_processor$process_query.invokeStatic(query_processor.clj:79)","query_processor$process_query.invoke(query_processor.clj:72)","query_processor.card$process_query_for_card_default_qp.invokeStatic(card.clj:235)","query_processor.card$process_query_for_card_default_qp.invoke(card.clj:231)","query_processor.card$process_query_for_card_default_run_fn$fn__89846$fn__89847.invoke(card.clj:243)","query_processor.streaming$_streaming_response$fn__86559$fn__86560$fn__86561.invoke(streaming.clj:225)","query_processor.streaming$_streaming_response$fn__86559$fn__86560.invoke(streaming.clj:223)","query_processor.streaming$do_with_streaming_rff.invokeStatic(streaming.clj:214)","query_processor.streaming$do_with_streaming_rff.invoke(streaming.clj:201)","query_processor.streaming$_streaming_response$fn__86559.invoke(streaming.clj:220)","server.streaming_response$do_f_STAR_.invokeStatic(streaming_response.clj:83)","server.streaming_response$do_f_STAR_.invoke(streaming_response.clj:81)","server.streaming_response$do_f_async$task__84295.invoke(streaming_response.clj:98)"],"card_id":1543,"context":"csv-download","error":"ERROR: column \"%demo%\" does not exist\n  Position: 10631","row_count":0,"running_time":0,"data":{"rows":[],"cols":[]}}